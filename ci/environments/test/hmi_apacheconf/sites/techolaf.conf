<VirtualHost *:80>
   ServerName 127.0.0.1:92

   # Redirect users to the https site if they came to http
   # JWP 10/4/21: I don't think this is working right now due to
   # DocumentRoot being configured in /etc/httpd/conf/httpd.conf
   # right now.
   Redirect / https://127.0.0.1:92
</VirtualHost>

<VirtualHost *:443>
	ServerName 127.0.0.1:92

	ServerAdmin admin@techolaf.com
	DocumentRoot /usr/local/apache2/techolaf

# 	<Directory "/usr/local/apache2/techolaf">
# 		Order allow,deny
# 		AllowOverride All
# 		Allow from all
# 		Require all granted
# 	</Directory>

    #This directive toggles the usage of the SSL/TLS Protocol Engine for proxy. Without this you cannot use HTTPS URL as your Origin Server
#     SSLProxyEngine on
#     SSLProxyVerify none
#     SSLProxyCheckPeerCN off
#     SSLProxyCheckPeerName off
#     SSLProxyCheckPeerExpire off

    # To prevent SSL Offloading
    # Set the X-Forwarded-Proto to be https for your Origin Server to understand that this request is made over HTTPS #https://httpd.apache.org/docs/2.2/mod/mod_headers.html#requestheader.
    RequestHeader set X-Forwarded-Proto “https”
    RequestHeader set X-Forwarded-Port “443”

    ErrorLog logs/techolaf-error.log
    CustomLog logs/techolaf-access.log combined


    SSLProxyEngine on

    <Location "/api/">
        ProxyPass "https://api.navyanalytics.com:5000/KMAPI/"
        ProxyPassReverse "https://api.navyanalytics.com:5000/KMAPI/"
    </Location>

   #<Location /balancer-manager>
     #SetHandler balancer-manager
   #</Location>

   Include /etc/letsencrypt/options-ssl-apache.conf
   SSLCertificateFile /etc/letsencrypt/live/navyanalytics.com/fullchain.pem
   SSLCertificateKeyFile /etc/letsencrypt/live/navyanalytics.com/privkey.pem

</VirtualHost>
